[{"content":"Googleの日本語改行ライブラリ、Budouの後継版に当たるBudouXが公開されたので、GitHub Actions上で走らせてみました。\n Webアプリで試してみる まずは公式デモアプリを使い、日本語版Lorem Ipsumとしておなじみのイーハトーブを変換してみます。\n原文\n あのイーハトーヴォのすきとおった風、夏でも底に冷たさをもつ青いそら、うつくしい森で飾られたモリーオ市、郊外のぎらぎらひかる草の波。山路を登りながら、こう考えた。智に働けば角が立つ。情に棹させば流される。意地を通せば窮屈だ。とかくに人の世は住みにくい。住みにくさが高じると、安い所へ引き越したくなる。どこへ越しても住みにくいと悟った時、詩が生れて、画が出来る。\n 変換後\n あのイーハトーヴォのすきとおった風、夏でも底に冷たさをもつ青いそら、うつくしい森で飾られたモリーオ市、郊外のぎらぎらひかる草の波。山路を登りながら、こう考えた。智に働けば角が立つ。情に棹させば流される。意地を通せば窮屈だ。とかくに人の世は住みにくい。住みにくさが高じると、安い所へ引き越したくなる。どこへ越しても住みにくいと悟った時、詩が生れて、画が出来る。\n かなり読みやすくなっています。\nPythonで動かしてみる 次に、BudouXをインストールしたPython環境で試してみます。\nimport budoux parser = budoux.load_default_japanese_parser() print(parser.translate_html_string(\u0026#39;あのイーハトーヴォのすきとおった風、夏でも底に冷たさをもつ青いそら、うつくしい森で飾られたモリーオ市、郊外のぎらぎらひかる草の波。\u0026#39;)) このようなHTMLコードが出力されます。\n\u0026lt;span style=\u0026quot;word-break: keep-all; overflow-wrap: break-word;\u0026quot;\u0026gt;あのイーハトーヴォの\u0026lt;wbr\u0026gt;すきと\u0026lt;wbr\u0026gt;おった\u0026lt;wbr\u0026gt;風、\u0026lt;wbr\u0026gt;夏でも\u0026lt;wbr\u0026gt;底に\u0026lt;wbr\u0026gt;冷たさを\u0026lt;wbr\u0026gt;もつ\u0026lt;wbr\u0026gt;青いそら、\u0026lt;wbr\u0026gt;うつくしい\u0026lt;wbr\u0026gt;森で\u0026lt;wbr\u0026gt;飾られた\u0026lt;wbr\u0026gt;モリーオ市、\u0026lt;wbr\u0026gt;郊外の\u0026lt;wbr\u0026gt;ぎらぎらひかる\u0026lt;wbr\u0026gt;草の\u0026lt;wbr\u0026gt;波。\u0026lt;/span\u0026gt; より簡単に使えるようにするため、budou_x.pyというスクリプトを書きました。\n# ./source/budou_x.py import sys args = sys.argv input_file = args[1] output_file = args[2] def budou_x_convert(): text_file = open(input_file, \u0026#39;r\u0026#39;) text = text_file.read() text_file.close() import budoux parser = budoux.load_default_japanese_parser() converted_text = parser.translate_html_string(text) # print(converted_text) f = open(output_file, \u0026#39;w\u0026#39;) f.write(converted_text) f.close() budou_x_convert() # usage # $ python3 budou_x.py input_file output_file ワンライナーで実行できます。\nGitHub Actions 上で動かしてみる 上記のスクリプトをGitHub Actions上で実行します。今回は1つのリポジトリの中で完結しているため、デプロイキーやシークレットの設定はしていません。サンプルとして、content/posts/budoux-on-blog/source配下のtxtファイルを変換しています。\nname:A GitHub Actionon:push:branches:- mainjobs:budou-x:name:Run BudouXruns-on:ubuntu-lateststeps:- name:Checkoutuses:actions/checkout@v2- name:Set up Python 3.9uses:actions/setup-python@v2with:python-version:3.9- name:Install dependenciesrun:| pip install budoux- name:Run scriptrun:|python ${PATH}/budou_x.py ${PATH}/example.txt ${PATH}/converted_example.html git config --global user.name ${NAME} git config --global user.email ${EMAIL} git add . git commit -m \u0026#34;ran GitHub Action\u0026#34; git push origin main env:PATH:\u0026#39;content/posts/budoux-on-blog/source\u0026#39;NAME:\u0026#39;USERNAME\u0026#39;EMAIL:\u0026#39;USER EMAIL\u0026#39;実行時間は6秒でした。\n メモ  👍 Cool  Budouと比べて軽量なので動的なサイトにも使える   👎 Hmm\u0026hellip;  \u0026lt;wbr\u0026gt;タグを多用するので、アクセシビリティ的に良くないかも    ","permalink":"https://eb1ta1.github.io/posts/budoux-on-blog/","summary":"Googleの日本語改行ライブラリ、Budouの後継版に当たるBudouXが公開されたので、GitHub Actions上で走らせてみました。\n Webアプリで試してみる まずは公式デモアプリを使い、日本語版Lorem Ipsumとしておなじみのイーハトーブを変換してみます。\n原文\n あのイーハトーヴォのすきとおった風、夏でも底に冷たさをもつ青いそら、うつくしい森で飾られたモリーオ市、郊外のぎらぎらひかる草の波。山路を登りながら、こう考えた。智に働けば角が立つ。情に棹させば流される。意地を通せば窮屈だ。とかくに人の世は住みにくい。住みにくさが高じると、安い所へ引き越したくなる。どこへ越しても住みにくいと悟った時、詩が生れて、画が出来る。\n 変換後\n あのイーハトーヴォのすきとおった風、夏でも底に冷たさをもつ青いそら、うつくしい森で飾られたモリーオ市、郊外のぎらぎらひかる草の波。山路を登りながら、こう考えた。智に働けば角が立つ。情に棹させば流される。意地を通せば窮屈だ。とかくに人の世は住みにくい。住みにくさが高じると、安い所へ引き越したくなる。どこへ越しても住みにくいと悟った時、詩が生れて、画が出来る。\n かなり読みやすくなっています。\nPythonで動かしてみる 次に、BudouXをインストールしたPython環境で試してみます。\nimport budoux parser = budoux.load_default_japanese_parser() print(parser.translate_html_string(\u0026#39;あのイーハトーヴォのすきとおった風、夏でも底に冷たさをもつ青いそら、うつくしい森で飾られたモリーオ市、郊外のぎらぎらひかる草の波。\u0026#39;)) このようなHTMLコードが出力されます。\n\u0026lt;span style=\u0026quot;word-break: keep-all; overflow-wrap: break-word;\u0026quot;\u0026gt;あのイーハトーヴォの\u0026lt;wbr\u0026gt;すきと\u0026lt;wbr\u0026gt;おった\u0026lt;wbr\u0026gt;風、\u0026lt;wbr\u0026gt;夏でも\u0026lt;wbr\u0026gt;底に\u0026lt;wbr\u0026gt;冷たさを\u0026lt;wbr\u0026gt;もつ\u0026lt;wbr\u0026gt;青いそら、\u0026lt;wbr\u0026gt;うつくしい\u0026lt;wbr\u0026gt;森で\u0026lt;wbr\u0026gt;飾られた\u0026lt;wbr\u0026gt;モリーオ市、\u0026lt;wbr\u0026gt;郊外の\u0026lt;wbr\u0026gt;ぎらぎらひかる\u0026lt;wbr\u0026gt;草の\u0026lt;wbr\u0026gt;波。\u0026lt;/span\u0026gt; より簡単に使えるようにするため、budou_x.pyというスクリプトを書きました。\n# ./source/budou_x.py import sys args = sys.argv input_file = args[1] output_file = args[2] def budou_x_convert(): text_file = open(input_file, \u0026#39;r\u0026#39;) text = text_file.read() text_file.close() import budoux parser = budoux.load_default_japanese_parser() converted_text = parser.translate_html_string(text) # print(converted_text) f = open(output_file, \u0026#39;w\u0026#39;) f.write(converted_text) f.close() budou_x_convert() # usage # $ python3 budou_x.","title":"BudouXをPythonで実行し、GitHub Actionsで使ってみる"}]